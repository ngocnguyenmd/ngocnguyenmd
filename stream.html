<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chọn Tập Phim</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #121212; /* Nền tối */
            color: white;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
        }

        .episode-list {
            display: flex;
            flex-wrap: wrap; 
            justify-content: center; 
        }

        .episode-list button {
            background-color: #ff0000; 
            color: white; 
            padding: 10px; 
            border: none; 
            border-radius: 5px;
            cursor: pointer; 
            margin: 5px;
        }

        .episode-list button:hover {
            background-color: #cc0000; 
        }
      
        .button-container {
            margin-top: 20px;
            display: flex;
            justify-content: center; 
        }
      
        .back-button, .home-button {
            background-color: #ff0000; 
            color: white; 
            padding: 10px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer;
            margin: 0 10px;
        }
      
        .back-button:hover, .home-button:hover {
            background-color: #cc0000; 
        }
    </style>
</head>
<body>

    <h1>Chọn Tập Phim</h1>

    <!-- Danh sách các tập phim -->
    <div id="episodeMenu" class="episode-list"></div>

    <!-- Nút quay lại danh sách tập và trang chủ -->
    <div class="button-container">
        <button class="back-button" onclick="goBack()">Quay lại danh sách tập</button>
        <button class="home-button" onclick="goHome()">Quay lại trang chủ</button>
    </div>

    <script>
        // Lấy thông tin từ URL
        const urlParams = new URLSearchParams(window.location.search);
        const movie = urlParams.get('movie');

        function loadEpisodes() {
            const episodeMenu = document.getElementById('episodeMenu');
            episodeMenu.innerHTML = ''; // Xóa nội dung cũ

            fetch('links.txt')
                .then(response => response.text())
                .then(data => {
                    const lines = data.trim().split("\n"); // Cắt từng dòng
                    let currentMovie = null;
                    const movieLinks = [];

                    // Duyệt từng dòng trong links.txt
                    lines.forEach(line => {
                        line = line.trim();
                        if (line.startsWith("#")) {
                            // Nếu là dòng chứa tên phim (# movie01kr)
                            currentMovie = line.substring(1).trim(); // Bỏ dấu "#"
                        } else if (currentMovie === movie && line !== "") {
                            // Nếu dòng này thuộc bộ phim đang được chọn và có link
                            movieLinks.push(line);
                        }
                    });

                    // Hiển thị danh sách tập
                    if (movieLinks.length > 0) {
                        movieLinks.forEach((link, index) => {
                            const button = document.createElement('button');
                            button.innerText = `Tập ${index + 1}`;
                            button.onclick = () => window.location.href = `play.html?link=${encodeURIComponent(link)}`;
                            episodeMenu.appendChild(button);
                        });
                    } else {
                        episodeMenu.innerHTML = "<p>Không tìm thấy tập phim.</p>";
                    }
                })
                .catch(error => {
                    console.error("Lỗi tải links.txt:", error);
                    episodeMenu.innerHTML = "<p>Không thể tải danh sách tập phim.</p>";
                });
        }

        function goBack() {
            window.history.back(); // Quay lại trang trước đó
        }
         
        function goHome() {
            window.location.href = 'index.html'; // Chuyển hướng đến trang chủ
        }

        window.onload = loadEpisodes; // Tải danh sách khi trang được tải
    </script>

</body>
</html>